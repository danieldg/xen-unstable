#!/usr/bin/env python

import os, sys, xend.main

def main():
    if not sys.argv[1:]:
        print 'usage: %s {start|stop|restart}' % sys.argv[0]
    elif os.fork():
        pid, status = os.wait()
        return status >> 8
    elif sys.argv[1] == 'start':
        return xend.main.start_daemon()
    elif sys.argv[1] == 'stop':
        return xend.main.stop_daemon()
    elif sys.argv[1] == 'restart':
        return xend.main.stop_daemon() or xend.main.start_daemon()
    else:
        print 'not an option:', sys.argv[1]
    return 1

if __name__ == '__main__':
    sys.exit(main())
