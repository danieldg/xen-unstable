Refresh Virtual Disk
SECTION&XenoServers
BREADCRUMB&Virtual Disk Manager&vd.jsp

<!-- content -->
<img src="pixel.gif" class="block" width="1" height="12">

<table cellpadding="0" cellspacing="0" border="0">
<tbody>
INCLUDE&vdmenu.tmpl
<td valign="top">

<%
  HttpServletRequestWrapper hsrw = new HttpServletRequestWrapper(request);

  String vds[] = hsrw.getParameterValues("vd");
  long expiry;

  if (vds == null || vds.length == 0)
  {
%>
Error: No virtual disk chosen.<br>
<%
  }
  else if (hsrw.getParameter("expiry") == null ||
           hsrw.getParameter("expiry").trim().equals(""))
  {
%>
Error: expiry time not specified.<br>
<%
  }
  else
  {
    expiry = Long.decode(hsrw.getParameter("expiry")).longValue(); 

    /* not perfect, but good enough for now... */
    if ( hsrw.getParameter("expiryunits").equals("d"))
    {
      expiry *= 24 * 60 * 60 * 1000;
    }
    else if ( hsrw.getParameter("expiryunits").equals("w"))
    {
      expiry *= 24 * 60 * 60 * 1000 * 7;
    }
    else if ( hsrw.getParameter("expiryunits").equals("m"))
    {
      expiry *= 24 * 60 * 60 * 1000 * 30;
    }
    else if ( hsrw.getParameter("expiryunits").equals("y"))
    {
      expiry *= 24 * 60 * 60 * 1000 * 365;
    }

	expiry += System.currentTimeMillis();
	
    for (int i = 0; i < vds.length; i++)
    {
%>
vd = <%= new CommandVdRefresh(vds[i], new Date(expiry)).executeWeb() %> <br>
<%
    }
  }
%>

<%
  root.doFlushState();
%>


</td>
</tbody>
</table>




<!-- end content -->
